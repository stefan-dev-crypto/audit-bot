Contract Address: 0xf5042e6ffac5a625d4e7848e0b01373d8eb9e222
Source File: 126_0xf5042e6ffac5a625d4e7848e0b01373d8eb9e222.sol
Audit Date: 2026-01-14T17:28:15.450Z
Model: gpt-4.1

================================ AUDIT RESULT ================================

Critical Vulnerability: ðŸš¨ YES

Summary:
Any external user can freely transfer all ETH, ERC20, and NFTs (ERC721/1155) held by the contract to themselves or any arbitrary address, due to lack of access control on the cleanup and withdrawal functions.

Attack Surface: ETH, ERC20, ERC721, ERC1155


Critical Issues Found:

1. Unrestricted Fund and Token Withdrawal
   Type: Missing Access Control
   Function: cleanupErc20s, cleanupErc20sViaCall, cleanupNative, cleanupNativeViaCall
   
   Attack Scenario:
   An attacker calls any of the 'cleanupErc20s', 'cleanupErc20sViaCall', 'cleanupNative', or 'cleanupNativeViaCall' functions and specifies their own address as the recipient. The contract will transfer all held ERC20 tokens or native ETH to the attacker's address. There is no restriction to prevent arbitrary external callers from draining all the contractâ€™s funds.
   
   Impact:
   Complete theft of all ETH and tokens (ERC20/ERC721/ERC1155) held by the contract.
   
   Recommended Fix:
   Implement appropriate access control, such as only allowing the contract owner or trusted addresses to call withdrawal and cleanup functions.


2. Unrestricted NFT Extraction via ERC721 and ERC1155 Callbacks
   Type: Missing Access Control
   Function: onERC721Received, onERC1155Received, onERC1155BatchReceived
   
   Attack Scenario:
   An attacker can front-run or replay ERC721 or ERC1155 token transfers to the contract with crafted calldata/nftRecipient. The contract will automatically forward any received NFTs to the recipient address set (which can be set by the attacker via multicall), allowing arbitrary extraction of NFTs with no control.
   
   Impact:
   Theft of any ERC721/ERC1155 tokens sent to the contract.
   
   Recommended Fix:
   Restrict the ability to set or manipulate the NFT recipient, and limit issuance of callbacks to trusted parties.



==============================================================================

Raw JSON:
{
  "critical_vulnerability_exists": true,
  "summary": "Any external user can freely transfer all ETH, ERC20, and NFTs (ERC721/1155) held by the contract to themselves or any arbitrary address, due to lack of access control on the cleanup and withdrawal functions.",
  "attack_surface": [
    "ETH",
    "ERC20",
    "ERC721",
    "ERC1155"
  ],
  "critical_issues": [
    {
      "title": "Unrestricted Fund and Token Withdrawal",
      "vulnerability_type": "Missing Access Control",
      "affected_function": "cleanupErc20s, cleanupErc20sViaCall, cleanupNative, cleanupNativeViaCall",
      "attack_scenario": "An attacker calls any of the 'cleanupErc20s', 'cleanupErc20sViaCall', 'cleanupNative', or 'cleanupNativeViaCall' functions and specifies their own address as the recipient. The contract will transfer all held ERC20 tokens or native ETH to the attacker's address. There is no restriction to prevent arbitrary external callers from draining all the contractâ€™s funds.",
      "impact": "Complete theft of all ETH and tokens (ERC20/ERC721/ERC1155) held by the contract.",
      "recommended_fix": "Implement appropriate access control, such as only allowing the contract owner or trusted addresses to call withdrawal and cleanup functions."
    },
    {
      "title": "Unrestricted NFT Extraction via ERC721 and ERC1155 Callbacks",
      "vulnerability_type": "Missing Access Control",
      "affected_function": "onERC721Received, onERC1155Received, onERC1155BatchReceived",
      "attack_scenario": "An attacker can front-run or replay ERC721 or ERC1155 token transfers to the contract with crafted calldata/nftRecipient. The contract will automatically forward any received NFTs to the recipient address set (which can be set by the attacker via multicall), allowing arbitrary extraction of NFTs with no control.",
      "impact": "Theft of any ERC721/ERC1155 tokens sent to the contract.",
      "recommended_fix": "Restrict the ability to set or manipulate the NFT recipient, and limit issuance of callbacks to trusted parties."
    }
  ]
}
