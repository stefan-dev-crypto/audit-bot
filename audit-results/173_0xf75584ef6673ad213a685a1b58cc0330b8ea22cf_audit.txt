Contract Address: 0xf75584ef6673ad213a685a1b58cc0330b8ea22cf
Source File: 173_0xf75584ef6673ad213a685a1b58cc0330b8ea22cf.sol
Audit Date: 2026-01-14T17:41:59.022Z
Model: gpt-4.1

================================ AUDIT RESULT ================================

Critical Vulnerability: ðŸš¨ YES

Summary:
The contract allows arbitrary execution of code and ETH/token transfers by any external user via the VM-like execution in EnsoShortcuts. There are no access restrictions on the 'routeSingle', 'routeMulti', 'safeRouteSingle', or 'safeRouteMulti' functions, and the execution context in '_execute' allows any user to supply arbitrary data to the shortcuts contract. This enables external attackers to steal all ETH and approved tokens held by the contract.

Attack Surface: ETH, ERC20, ERC721, ERC1155


Critical Issues Found:

1. Arbitrary Code Execution and Fund Drain via Shortcuts
   Type: Unrestricted Arbitrary Call/Execution
   Function: _execute (used by routeSingle, routeMulti, safeRouteSingle, safeRouteMulti)
   
   Attack Scenario:
   An attacker can supply arbitrary calldata to 'routeSingle' or 'routeMulti' (or their 'safe' versions), which is forwarded to the EnsoShortcuts contract's fallback via '_execute'. The EnsoShortcuts contract's AbstractEnsoShortcuts inherits the generic VM, which can execute arbitrary call/value transfer instructions. There are no checks or restrictions on what the supplied input can do; thus, any user can execute arbitrary calls from the contract, including transferring out all ETH, ERC20, ERC721, and ERC1155 tokens in its possession, or calling external contracts.
   
   Impact:
   A general external user can steal all ETH, ERC20, ERC721, and ERC1155 tokens held by the contract at any time; the action requires no owner/admin privilege.
   
   Recommended Fix:
   Restrict usage of the main routing/execution functions to trusted actors only or implement strict validation/sanitization of executable data before calling them. Consider limiting the functionality of the VM or EnsoShortcuts so that external users cannot execute arbitrary calls or withdrawals.



==============================================================================

Raw JSON:
{
  "critical_vulnerability_exists": true,
  "summary": "The contract allows arbitrary execution of code and ETH/token transfers by any external user via the VM-like execution in EnsoShortcuts. There are no access restrictions on the 'routeSingle', 'routeMulti', 'safeRouteSingle', or 'safeRouteMulti' functions, and the execution context in '_execute' allows any user to supply arbitrary data to the shortcuts contract. This enables external attackers to steal all ETH and approved tokens held by the contract.",
  "attack_surface": [
    "ETH",
    "ERC20",
    "ERC721",
    "ERC1155"
  ],
  "critical_issues": [
    {
      "title": "Arbitrary Code Execution and Fund Drain via Shortcuts",
      "vulnerability_type": "Unrestricted Arbitrary Call/Execution",
      "affected_function": "_execute (used by routeSingle, routeMulti, safeRouteSingle, safeRouteMulti)",
      "attack_scenario": "An attacker can supply arbitrary calldata to 'routeSingle' or 'routeMulti' (or their 'safe' versions), which is forwarded to the EnsoShortcuts contract's fallback via '_execute'. The EnsoShortcuts contract's AbstractEnsoShortcuts inherits the generic VM, which can execute arbitrary call/value transfer instructions. There are no checks or restrictions on what the supplied input can do; thus, any user can execute arbitrary calls from the contract, including transferring out all ETH, ERC20, ERC721, and ERC1155 tokens in its possession, or calling external contracts.",
      "impact": "A general external user can steal all ETH, ERC20, ERC721, and ERC1155 tokens held by the contract at any time; the action requires no owner/admin privilege.",
      "recommended_fix": "Restrict usage of the main routing/execution functions to trusted actors only or implement strict validation/sanitization of executable data before calling them. Consider limiting the functionality of the VM or EnsoShortcuts so that external users cannot execute arbitrary calls or withdrawals."
    }
  ]
}
